# Configure generic and secure options for local file logging.


####################################
####         Templates          ####
####################################

# https://www.rsyslog.com/doc/v8-stable/configuration/templates.html
template(name="LocalFormat" type="list") {
  property(name="timereported" dateFormat="rfc3339")
  constant(value=" ")
  property(name="hostname")
  constant(value=" ")
  property(name="syslogtag")
  property(name="msg" spifno1stsp="on" )
  property(name="msg" droplastlf="on" )
  constant(value="\n")
}

####################################
####          Modules           ####
####################################

# Provides the core functionality of writing messages to files residing inside the local file system.
# https://www.rsyslog.com/doc/v8-stable/configuration/modules/omfile.html#module-parameters
module(
  load="builtin:omfile"

  # Set the default template to be used if an action is not configured to use a specific template.
  Template="LocalFormat"

  # Default owner for log files.
  fileOwnerNum="1000"

  # Default group for log files.
  fileGroupNum="1000"

  # Default owner for created directories.
  dirOwnerNum="1000"

  # Default group for created directories.
  dirGroupNum="1000"

  # Default file creation mode.
  fileCreateMode="0600"

  # Default directory creation mode.
  dirCreateMode="0700"
)